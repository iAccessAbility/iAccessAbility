<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="UTF-8">
        <meta name="author" content="Leah Dykema">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" type="image/x-icon" href="../img/favicon.ico">
        <title>Services - iAccessAbility</title>
        <link rel="stylesheet" href="../stylesheets/services-form.css">
        <link rel="stylesheet" href="../stylesheets/accessibility.css">
        <link rel="stylesheet" href="../navbar/navbar.css">
    </head>
    <body>
        <!-- Navigation -->
        <div class="nav-container" data-role="header" data-position="fixed">
            <nav>
                <!-- Top row: menu button on left, logo on right -->
                <div class="mobile-header">
                    <!-- iAccessAbility -->
                    <div class="logo-container">
                        <a href="/index.html" aria-label="Home"><img class="link-logo" src="/img/logo-colored.svg" alt="I Access Ability"></a>
                        <a href="/index.html" class="links"><h1 class="name" aria-label="I Access Ability">iAccessAbility</h1></a>
                    </div>
                    <!-- Mobile Menu Toggle Button -->
                    <button class="menu-toggle" aria-expanded="false" aria-label="Toggle menu">
                        <span class="menu-icon-container">
                            <span class="menu-line"></span>
                            <span class="menu-line"></span>
                        </span>
                    </button>
                </div>
                <!-- Desktop Navigation -->
                <ul class="desktop-nav">
                    <li><a href="/index.html"><img class="link-logo" src="/img/logo-colored.svg" alt="I Access Ability"></a></li>
                    <li><a href="/news/index.html">News</a></li>
                    <li><a href="/blog/index.html">Blog</a></li>
                    <li><a href="/html/recommendations.html">Recommendations</a></li>
                    <li><a href="/html/support-articles.html">Support Articles</a></li>
                    <li><a href="/html/about.html">About</a></li>
                    <li><a href="/html/connect.html">Connect</a></li>
                </ul>
                <!-- Mobile Navigation (initially hidden) -->
                <ul id="mobile-menu" class="mobile-nav" aria-hidden="true">
                    <li><a href="/index.html" tabindex="-1">Home</a></li>
                    <li><a href="/news/index.html" tabindex="-1">News</a></li>
                    <li><a href="/blog/index.html" tabindex="-1">Blog</a></li>
                    <li><a href="/html/recommendations.html" tabindex="-1">Recommendations</a></li>
                    <li><a href="/html/support-articles.html" tabindex="-1">Support Articles</a></li>
                    <li><a href="/html/about.html" tabindex="-1">About</a></li>
                    <li><a href="/html/connect.html" tabindex="-1">Connect</a></li>
                </ul>
            </nav>
        </div>
        <!-- Services Form -->
        <main class="site">
            <h2>Request Services</h2>
            <div class="form">
                <form id="ServiceRequest" method="POST" action="https://formsubmit.co/iAccessAbility@gmail.com">
                    <input type="date" name="Date" id="current-date" hidden>
                    <label>First Name&#58;</label>
                    <input type="text" name="First Name" required size="15" maxlength="15" placeholder="John" tabindex="2">
                    <br>
                    <label>Last Name&#58;</label>
                    <input type="text" name="Last Name" required size="15" maxlength="15" placeholder="Appleseed" tabindex="2">
                    <br>
                    <label>Phone&#58;</label>
                    <input type="tel" name="Phone Number" required size="15" placeholder="(555) 555-5555" tabindex="2">
                    <br>
                    <label>Email&#58;</label>
                    <input type="email" name="Email Address" required size="22" placeholder="johnappleseed@example.com" tabindex="2">
                    <br>
                    <label>Service Request&#58;</label>
                    <select name="Service" required tabindex="2">
                        <option selected disabled>Select a Service</option>
                        <option value="Tech Support" tabindex="3">Tech Support</option>
                        <option value="Personalized Consulting" tabindex="3">Buying Consulting</option>
                        <option value="One-on-One Training" tabindex="3">One-on-One Training</option>
                    </select>
                    <br>
                    <label>Communication Preference&#58;</label>
                    <select name="Communication" required tabindex="2">
                        <option selected disabled>Select</option>
                        <option value="SMS" tabindex="3">Direct Text</option>
                        <option value="call" tabindex="3">Phone Call</option>
                        <option value="email" tabindex="3">Email</option>
                        <option value="WhatsApp Text" tabindex="3">WhatsApp Text</option>
                        <option value="WhatsApp Call" tabindex="3">WhatsApp Call</option>
                        <option value="Telegram Text" tabindex="3">Telegram Text</option>
                    </select>
                    <br>
                    <div class="agree-section">
                        <label for="agreement">
                            <input type="checkbox" id="agreement" name="payment-acceptance" required tabindex="2">
                            I agree to use Venmo or PayPal to pay for my services with iAccessAbility.
                        </label>
                    </div>
                    <br>
                    <!-- FormSubmit -->
                    <input type="submit" name="request" value="Request Service" role="button" class="submit" id="btn" tabindex="3" disabled>
                    <input type="hidden" name="_next" value="https://leahdykema.github.io/iAccessAbility/html/thankyou.html">
                    <input type="hidden" name="_captcha" value="false">
                    <input type="hidden" name="_template" value="table">
                    <input type="hidden" name="_autoresponse" value="Thank you for request, iAccessAbility will be in touch soon!">
                </form>
            </div>
            <br>
            <div>
                <p class="info">Services are only available to individuations in the U&#46;S&#46; and in&#45;person sessions are only available to locals of Pella&#44; IA&#46;</p>
                <p class="info">Please note that iAccessAbility services uses PayPal and Venmo for all transactions with clients for security reasons&#46;</p>
                <p class="info">Note&#44; I am in the Central Standard Time Zone &#40;CST&#41;&#44;&#46; All communication and references to time will be in Central Time&#46;</p>
                <p class="info">For any questions&#44; please contact me at&#58; <a class="links" href="mailto:support@iaccessabilityservices.com?subject=Request%20Service%20Inquiries" tabindex="4">support&#64;iAccessAbillityServices&#46;com</a></p>
            </div>
        </main>
        <script>
            document.getElementById("ServiceRequest").addEventListener("submit", async function(event) {
            event.preventDefault(); // Prevent default submission first
            let formData = new FormData(this);
            try {
                // Send data to Google Sheets via Apps Script Webhook
                const response = await fetch("https://script.google.com/macros/s/AKfycbxXSJDlJSDJwRC_Chk8lD4twhzeKzyommhMcH3ICSbKhUg31awIBSnilSj9su0viVA5/exec", {
                    method: "POST",
                    body: formData
                });
                // Check if the response is successful
                if (response.ok) {
                    console.log("Data submitted successfully to Google Sheets.");
                } else {
                    console.error("Failed to submit data:", response.statusText);
                }
            } catch (error) {
                console.error("Error submitting data:", error);
            }
            // Now submit the form to FormSubmit (if needed)
            this.submit();
        });

            document.addEventListener("DOMContentLoaded", () => {
                const form = document.querySelector("form");
                const submitButton = document.querySelector('input[name="request"]');

                // Function to check if all required fields are filled
                const checkFormCompletion = () => {
                    const allFieldsFilled = [...form.querySelectorAll("input[required], select[required]")].every(input => {
                        return input.type === "checkbox" ? input.checked : input.value.trim() !== "";
                    });

                    submitButton.disabled = !allFieldsFilled;
                };

                // Event listeners for input changes
                form.addEventListener("input", checkFormCompletion);
            });
        </script>
        <script src="../navbar/navbar.js"></script>
    </body>
</html>
